---
title: "Pre-Class Excersise 12"
author: "Pri Nonis"
output: html_document
---

The spending data frame contains simulated data on election results and campaign spending in the U.S. The dshare and rshare variables capture the vote shares for the Democratic and Republican parties respectively, while spent measures total spending on advertisements in millions of dollars for each race. For this exercise, think of spending as the outcome variable and the vote share variables as predictors.

```{r}
library(ggplot2)
library(ggfortify)
library(cowplot)
```

```{r}
load('elects.Rdata')
head(spending)
```

1. Is there a linear relationship between campaign spending and democratic vote share?
* Generate a scatter plot with a regression line.
* What does this scatter plot suggest about the appropriateness of the classical linear model assumptions in this case?

```{r}
plot(spending$dshare, spending$spent)
abline(lm(spending$spent ~ spending$dshare))
```

```{r}
autoplot(lm(spending$spent ~ spending$dshare))
```

2. If we want to improve this model, we have two options - add more variables or transform the variables
we have. Let’s try to add another variable first. Note that the two vote share variables do not sum to
one. This could be due to the existence of a third political party or to error in measuring votes. To
begin with, what assumption would be violated if the two variables did sum to one?

The CLM Assumption of No Perfect Multicolliniarity would be violated.

3. Since the two variables don’t sum exactly to one, we should be able to include republican vote share as
a second predictor. But before doing any coding, ask yourself what adding republican voteshare will do
to the precision of our estimate on the effect of democratic vote share. Explain why this effect makes
sense.


4. Now generate a model that predicts campaign spending using both democratic and republican vote
shares. What does the result tell you about the practical implications of very highly correlated
predictors?


```{r}
autoplot(lm(spending$spent ~ spending$dshare + spending$rshare))
```


5. Finally, what is the transformation of variables that might solve the problems identified thus far?
Perform that transformation and describe the results.

```{r}
p1 <- qplot(spending$spent, geom = "histogram")
p2 <- qplot(log(spending$spent), geom = "histogram")

plot_grid(p1,p2)
```

```{r}
autoplot(lm(log(spending$spent) ~ spending$dshare))
```

A log transformation solves the problems.


